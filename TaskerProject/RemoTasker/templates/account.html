<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My Account</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inria+Sans:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap">
    <link rel="stylesheet" href="../static/css/main.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
          integrity="sha512-..........." crossorigin="anonymous"/>

</head>
<body>
<nav class="w3-bar w3-black" style="justify-content:space-between;display:flex">
    <a href="{% url 'home' %}" style="text-decoration:none"><p id="title">EarnExtraDollar</p></a>
    <div style="padding:10px" class="nav-links">
        <a href="{%  url 'account' %}" class="w3-button w3-bar-item" style="color:#33E24F;">My Account</a>
        <a href="{%  url 'availableTasks' %}" class="w3-button w3-bar-item">Tasks</a>
        <a href="{%  url 'contact' %}" class="w3-button w3-bar-item">Contact</a>
        <a href="{%  url 'logout' %}" class="w3-button w3-bar-item">Log Out</a>
    </div>

</nav>
<div style="margin-left:5%">
    <div style="display:flex;justify-content:space-evenly;align-items:top">
        <div style="margin-top:20px;width:20%" class="left-content">
            <h3 style="color:red">My Account</h3>
            <dl>
                <dt>Username</dt>
                <dd class="desc">{{usr.username}}</dd>
                <dt>Email</dt>
                <dd class="desc">{{usr.email}}</dd>
                <dt>Paypal Email</dt>
                <dd class="desc">{{usr.paypalEmail}}</dd>
            </dl>
            <dl>
                <dt>Wallet</dt>
                <dd>Actual Balance: $<span id="withdrawable_balance" class="desc">{{usr.balanceActual}}</span></dd>
                <dd>Balance on hold:<span class="desc"> ${{usr.balanceHold}}</span></dd>
                <dt>Withdrawals</dt>
                <dd>Pending:<span class="desc"> ${{usr.withdrawPending}}</span></dd>
                <dd>Successful:<span class="desc"> ${{usr.withdrawSuccess}}</span></dd>
            </dl>
            <div style="background:#b4ccbc;border-radius:15px;align-items:center;display:flex;justify-content:center">
                <p style="font-size:45px;font-weight:800;letter-spacing:2;padding:0px;color:#048730">${{usr.balanceActual}}</p>
            </div>
        </div>
        <div style="background:#EBEBEB ;padding:20px;margin-top:50px;border-radius:15px;margin-right:50px;height:50vh">
            <h3 style="color:red">Request Withdrawal</h3>
            <form action="{% url 'account' %}" method="POST" class="amount-withdraw">
                {% csrf_token %}
                <label for="amount">Amount:</label><br>
                <input type="number" placeholder="Enter amount" name="amount" id="amount"><br>
                <small id="amount-desc" style="color:red">Minimum amount 25$</small>
                <p>Note: Payment is made to the PayPal account under your profile.</p>
                <button type="submit" id="withdraw-btn" disabled>WITHDRAW</button>
            </form>
        </div>
        <div style="margin-right:0px;width:60%;">
            <h3 style="color:red">Notifications</h3>
            <div style="overflow-y:scroll;height:70vh">
                {% if notf %}
                {% for n in notf %}
                {% if n.isRead %}
                <div>
                    <p>{{n.message}}</p>
                    <hr>

                </div>
                {% else %}
                <div>
                    <p><strong>{{n.message}}</strong></p>
                    <hr>
                </div>

                {% endif %}
                {% endfor %}

                {% else %}
                <div>
                    <p>You have no new notifications </p>
                    <hr>
                </div>
                {% endif %}

            </div>
        </div>

    </div>

</div>
<script>
    $(document).ready(function(){
      $('#amount').keyup(function(){
          var wbal=$('#withdrawable_balance').text();
          var w_bal=parseInt(wbal,10);
          var ramt=$('#amount').val();
          var r_amt=parseInt(ramt,10);
          if(r_amt < 25){
              $('#amount-desc').text('Minimum amount $25');
              $('#withdraw-btn').prop('disabled',true)
          }
          else if(r_amt > w_bal){
              $('#withdraw-btn').prop('disabled',true)
              $('#amount-desc').text('Amount exceeds balance');
          }else{
              $('#withdraw-btn').prop('disabled',false)
              $('#amount-desc').text('');
          }
      });
    });


</script>
</body>
</html>

