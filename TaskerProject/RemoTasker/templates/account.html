<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My Account</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inria+Sans:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap">
    <link rel="stylesheet" href="../static/css/main.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
          integrity="sha512-..........." crossorigin="anonymous"/>

</head>
<body>
<nav class="w3-bar w3-black" style="justify-content:space-between;display:flex">
    <a href="{% url 'home' %}" style="text-decoration:none"><p id="title">EarnExtraDollar</p></a>
    <div style="padding:10px" class="nav-links">
        <a href="{%  url 'account' %}" class="w3-button w3-bar-item" style="color:#33E24F;">My Account</a>
        <a href="{%  url 'availableTasks' %}" class="w3-button w3-bar-item">Tasks</a>
        <a href="{%  url 'contact' %}" class="w3-button w3-bar-item">Contact</a>
        <a href="{%  url 'logout' %}" class="w3-button w3-bar-item">Log Out</a>
    </div>

</nav>
<div style="margin-right:20%;padding-left:20%;">
    <div style="display:flex;justify-content:space-evenly;align-items:top">
        <div style="margin-top:50px" class="left-content">
            <h3 style="color:red">My Account</h3>
            <dl>
                <dt>Username</dt>
                <dd class="desc">{{usr.username}}</dd>
                <dt>Email</dt>
                <dd class="desc">{{usr.email}}</dd>
                <dt>Paypal Email</dt>
                <dd class="desc">{{usr.paypal_email}}</dd>
            </dl>
            <dl>
                <dt>Balance</dt>
                <dd class="desc">$<span id="withdrawable_balance">{{usr.balance}}</span></dd>
                <dt>Pending</dt>
                <dd class="desc">${{usr.pending}}</dd>
                <dt>Withdrawals</dt>
                <dd class="desc">${{usr.withdrawn}}</dd>
            </dl>
        </div>
        <div style="background:#EBEBEB padding:20px;margin-top:50px">
            <h3 style="color:red">Request Withdrawal</h3>
            <form action="{% url 'account' %}" method="POST" class="amount-withdraw">
                {% csrf_token %}
                <label for="amount">Amount:</label><br>
                <input type="number" placeholder="Enter amount" name="amount" id="amount"><br>
                <small id="amount-desc" style="color:red">Minimum amount 25$</small>
                <p>Note: Payment is made to the PayPal account under your profile.</p>
                <button type="submit" id="withdraw-btn" disabled>WITHDRAW</button>
            </form>
        </div>
    </div>

</div>
<script>
    $(document).ready(function(){
      $('#amount').keyup(function(){
          var wbal=$('#withdrawable_balance').text();
          var w_bal=parseInt(wbal,10);
          var ramt=$('#amount').val();
          var r_amt=parseInt(ramt,10);
          if(r_amt < 25){
              $('#amount-desc').text('Minimum amount $25');
              $('#withdraw-btn').prop('disabled',true)

          }
          else if(r_amt > w_bal){
              $('#withdraw-btn').prop('disabled',true)
              $('#amount-desc').text('Amount exceeds balance');
          }else{
              $('#withdraw-btn').prop('disabled',false)
              $('#amount-desc').text('');
          }
      });
    });


</script>
</body>
</html>

